# Retrospective - Epic 1: Core Knowledge Graph Foundation

**Date:** 2025-12-16
**Facilitator:** Bob (Scrum Master)
**Participants:** Minh (Project Lead), Alice (PO), Charlie (Sr Dev), Dana (QA), Elena (Jr Dev)

---

## Executive Summary

Epic 1 successfully established the foundation of the `coretext` system. We achieved 100% story completion, delivering the core scaffolding, SurrealDB management, Markdown parsing, and Git synchronization. However, the team faced significant challenges with integration complexity and outdated knowledge regarding SurrealDB 2.0 syntax, leading to a "Lost in the Middle" scenario where unit tests passed but end-to-end user demos failed.

This retrospective marks a pivot in our process: **Moving from "Tests Passed" to "User Demo Verified" as our Definition of Done.**

---

## Epic 1 Review

### Delivery Metrics
*   **Stories Completed:** 5 / 5 (100%)
*   **Key Deliverables:**
    *   Project Scaffolding & Poetry Sync
    *   Local SurrealDB Management (Init/Start/Stop)
    *   AST-Based Markdown Parser (Link detection, node creation)
    *   Git Hooks (Pre-commit lint, Post-commit sync)
    *   Referential Integrity Validation

### What Went Well
1.  **Solid Foundation:** Story 1.1 (Scaffolding) and the project structure (`cli` vs `server`) proved resilient and easy to navigate for new developers.
2.  **Testing Infrastructure:** The investment in `pytest`, `pytest-asyncio`, and comprehensive `tests/data` fixtures provided a strong safety net.
3.  **UX Decisions:** The "Fail-Open" policy for Git hooks (Story 1.4) was a crucial UX win, preventing tool errors from blocking user workflow.
4.  **Resilience:** The team successfully debugged complex integration issues (Async hooks, DB auth, Schema conflicts) to deliver a working solution.

### Challenges & Lessons Learned
1.  **The "Lost in the Middle" Trap:**
    *   *Issue:* We had green unit tests for Story 1.4, but the feature failed during manual usage (Silent failures, `NONE` errors).
    *   *Root Cause:* Lack of end-to-end manual verification steps in the development loop.
    *   *Lesson:* **"Tests Passed" != "Feature Works".** We need manual user verification guides.

2.  **Outdated Knowledge (SurrealDB 2.0):**
    *   *Issue:* We implemented logic based on SurrealQL 1.x (e.g., `UPSERT` behavior, `file:` storage) which caused friction with the installed SurrealDB 2.0 version.
    *   *Root Cause:* Relying on training data/past knowledge for rapidly evolving tools without validating current documentation/behavior.
    *   *Lesson:* **Validate Emerging Tech.** We must "spike" or script proof-of-concepts for new tools before full implementation.

3.  **Complexity Scaling:**
    *   *Issue:* "The bigger the project goes, the more catastrophic any problem is." Small loopholes in early stories (like schema assumptions) compounded into blocking issues in later stories.
    *   *Lesson:* Rigorous integration testing must happen earlier.

---

## Action Plan & Commitments

### Process Changes (Immediate Effect)

1.  **Mandatory User Demo Guide:**
    *   **Requirement:** Every Story and Epic MUST output a specific "Demo Guide" (e.g., `docs/manual_test_guide.md`).
    *   **Content:** Step-by-step CLI commands and checks for the *User* (Minh) to perform.
    *   **Definition of Done:** A story is not done until the User can successfully follow the guide.

2.  **Tech Validation Spikes:**
    *   **Requirement:** Before implementing features with rapidly changing tech (Vector DB, MCP), create a standalone "Proof of Concept" script to verify syntax and behavior.

### Epic 1 Finalization
*   **Task:** Create `docs/epic-1-demo-guide.md` consolidating all manual verification steps for the foundational system.
*   **Status:** Assigned for immediate execution.

### Epic 2 Readiness
*   **Focus:** Apply "Tech Validation" strictly to Story 2.2 (Vector Search) and 2.3 (Graph Traversal) to avoid repeating the SurrealDB 2.0 syntax struggles.
*   **Preparation:** Ensure `nomic-embed-text` and MCP protocol details are verified via scripts before integrating.

---

## Next Steps

1.  **Generate `docs/epic-1-demo-guide.md`** (Immediate).
2.  **Update `sprint-status.yaml`** to mark Epic 1 Retro as complete.
3.  **Begin Epic 2 Planning**, incorporating the new "Spike" tasks for vector/graph logic.

**Meeting Adjourned.**
